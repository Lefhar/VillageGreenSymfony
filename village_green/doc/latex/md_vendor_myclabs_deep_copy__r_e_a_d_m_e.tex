Deep\+Copy helps you create deep copies (clones) of your objects. It is designed to handle cycles in the association graph.

\href{https://travis-ci.org/myclabs/DeepCopy}{\texttt{ }} \href{https://coveralls.io/r/myclabs/DeepCopy?branch=1.x}{\texttt{ }} \href{https://scrutinizer-ci.com/g/myclabs/DeepCopy/}{\texttt{ }} \href{https://packagist.org/packages/myclabs/deep-copy}{\texttt{ }}\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md520}{}\doxysection{Table of Contents}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md520}

\begin{DoxyEnumerate}
\item \href{\#how}{\texttt{ How}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#why}{\texttt{ Why}}
\begin{DoxyEnumerate}
\item \href{\#using-simply-clone}{\texttt{ Using simply {\ttfamily clone}}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#overridding-__clone}{\texttt{ Overridding {\ttfamily \+\_\+\+\_\+clone()}}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#with-deepcopy}{\texttt{ With {\ttfamily Deep\+Copy}}}
\end{DoxyEnumerate}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#how-it-works}{\texttt{ How it works}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#going-further}{\texttt{ Going further}}
\begin{DoxyEnumerate}
\item \href{\#matchers}{\texttt{ Matchers}}
\begin{DoxyEnumerate}
\item \href{\#property-name}{\texttt{ Property name}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#specific-property}{\texttt{ Specific property}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#type}{\texttt{ Type}}
\end{DoxyEnumerate}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#filters}{\texttt{ Filters}}
\begin{DoxyEnumerate}
\item \href{\#setnullfilter-filter}{\texttt{ {\ttfamily Set\+Null\+Filter}}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#keepfilter-filter}{\texttt{ {\ttfamily Keep\+Filter}}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#doctrinecollectionfilter-filter}{\texttt{ {\ttfamily Doctrine\+Collection\+Filter}}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#doctrineemptycollectionfilter-filter}{\texttt{ {\ttfamily Doctrine\+Empty\+Collection\+Filter}}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#doctrineproxyfilter-filter}{\texttt{ {\ttfamily Doctrine\+Proxy\+Filter}}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#replacefilter-type-filter}{\texttt{ {\ttfamily Replace\+Filter}}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#shallowcopyfilter-type-filter}{\texttt{ {\ttfamily Shallow\+Copy\+Filter}}}
\end{DoxyEnumerate}
\end{DoxyEnumerate}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#edge-cases}{\texttt{ Edge cases}}
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item \href{\#contributing}{\texttt{ Contributing}}
\begin{DoxyEnumerate}
\item \href{\#tests}{\texttt{ Tests}}
\end{DoxyEnumerate}
\end{DoxyEnumerate}\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md521}{}\doxysection{How?}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md521}
Install with Composer\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{composer require myclabs/deep-\/copy}

\end{DoxyCode}


Use simply\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$myCopy = \$copier-\/>copy(\$myObject);}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md522}{}\doxysection{Why?}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md522}

\begin{DoxyItemize}
\item How do you create copies of your objects?
\end{DoxyItemize}


\begin{DoxyCode}{0}
\DoxyCodeLine{\$myCopy = clone \$myObject;}

\end{DoxyCode}



\begin{DoxyItemize}
\item How do you create {\bfseries{deep}} copies of your objects (i.\+e. copying also all the objects referenced in the properties)?
\end{DoxyItemize}

You use \href{http://www.php.net/manual/en/language.oop5.cloning.php\#object.clone}{\texttt{ {\ttfamily \+\_\+\+\_\+clone()}}} and implement the behavior yourself.


\begin{DoxyItemize}
\item But how do you handle {\bfseries{cycles}} in the association graph?
\end{DoxyItemize}

Now you\textquotesingle{}re in for a big mess \+:(

\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md523}{}\doxysubsection{Using simply $<$tt$>$clone$<$/tt$>$}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md523}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md524}{}\doxysubsection{Overridding $<$tt$>$\+\_\+\+\_\+clone()$<$/tt$>$}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md524}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md525}{}\doxysubsection{With $<$tt$>$\+Deep\+Copy$<$/tt$>$}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md525}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md526}{}\doxysection{How it works}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md526}
Deep\+Copy recursively traverses all the object\textquotesingle{}s properties and clones them. To avoid cloning the same object twice it keeps a hash map of all instances and thus preserves the object graph.

To use it\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \textcolor{keyword}{function} DeepCopy\(\backslash\)deep\_copy;}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = deep\_copy(\$var);}

\end{DoxyCode}


Alternatively, you can create your own {\ttfamily Deep\+Copy} instance to configure it differently for example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy(\textcolor{keyword}{true});}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = \$copier-\/>copy(\$var);}

\end{DoxyCode}


You may want to roll your own deep copy function\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{namespace }Acme;}
\DoxyCodeLine{}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{function} deep\_copy(\$var)}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \textcolor{keyword}{static} \$copier = \textcolor{keyword}{null};}
\DoxyCodeLine{    }
\DoxyCodeLine{    \textcolor{keywordflow}{if} (\textcolor{keyword}{null} === \$copier) \{}
\DoxyCodeLine{        \$copier = \textcolor{keyword}{new} DeepCopy(\textcolor{keyword}{true});}
\DoxyCodeLine{    \}}
\DoxyCodeLine{    }
\DoxyCodeLine{    \textcolor{keywordflow}{return} \$copier-\/>copy(\$var);}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md527}{}\doxysection{Going further}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md527}
You can add filters to customize the copy process.

The method to add a filter is {\ttfamily Deep\+Copy\textbackslash{}Deep\+Copy\+::add\+Filter(\$filter, \$matcher)}, with {\ttfamily \$filter} implementing {\ttfamily Deep\+Copy\textbackslash{}Filter\textbackslash{}Filter} and {\ttfamily \$matcher} implementing {\ttfamily Deep\+Copy\textbackslash{}Matcher\textbackslash{}Matcher}.

We provide some generic filters and matchers.\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md528}{}\doxysubsection{Matchers}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md528}

\begin{DoxyItemize}
\item {\ttfamily Deep\+Copy\textbackslash{}Matcher} applies on a object attribute.
\item {\ttfamily Deep\+Copy\textbackslash{}Type\+Matcher} applies on any element found in graph, including array elements.
\end{DoxyItemize}\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md529}{}\doxysubsubsection{Property name}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md529}
The {\ttfamily Property\+Name\+Matcher} will match a property by its name\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_matcher_1_1_property_name_matcher}{DeepCopy\(\backslash\)Matcher\(\backslash\)PropertyNameMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Will apply a filter to any property of any objects named "{}id"{}}}
\DoxyCodeLine{\$matcher = \textcolor{keyword}{new} PropertyNameMatcher(\textcolor{stringliteral}{'id'});}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md530}{}\doxysubsubsection{Specific property}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md530}
The {\ttfamily Property\+Matcher} will match a specific property of a specific class\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_matcher_1_1_property_matcher}{DeepCopy\(\backslash\)Matcher\(\backslash\)PropertyMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Will apply a filter to the property "{}id"{} of any objects of the class "{}MyClass"{}}}
\DoxyCodeLine{\$matcher = \textcolor{keyword}{new} PropertyMatcher(\textcolor{stringliteral}{'MyClass'}, \textcolor{stringliteral}{'id'});}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md531}{}\doxysubsubsection{Type}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md531}
The {\ttfamily Type\+Matcher} will match any element by its type (instance of a class or any value that could be parameter of \href{http://php.net/manual/en/function.gettype.php}{\texttt{ gettype()}} function)\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_type_matcher_1_1_type_matcher}{DeepCopy\(\backslash\)TypeMatcher\(\backslash\)TypeMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// Will apply a filter to any object that is an instance of Doctrine\(\backslash\)Common\(\backslash\)Collections\(\backslash\)Collection}}
\DoxyCodeLine{\$matcher = \textcolor{keyword}{new} TypeMatcher(\textcolor{stringliteral}{'Doctrine\(\backslash\)Common\(\backslash\)Collections\(\backslash\)Collection'});}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md532}{}\doxysubsection{Filters}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md532}

\begin{DoxyItemize}
\item {\ttfamily Deep\+Copy\textbackslash{}Filter} applies a transformation to the object attribute matched by {\ttfamily Deep\+Copy\textbackslash{}Matcher}
\item {\ttfamily Deep\+Copy\textbackslash{}Type\+Filter} applies a transformation to any element matched by {\ttfamily Deep\+Copy\textbackslash{}Type\+Matcher}
\end{DoxyItemize}\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md533}{}\doxysubsubsection{$<$tt$>$\+Set\+Null\+Filter$<$/tt$>$ (filter)}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md533}
Let\textquotesingle{}s say for example that you are copying a database record (or a Doctrine entity), so you want the copy not to have any ID\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_filter_1_1_set_null_filter}{DeepCopy\(\backslash\)Filter\(\backslash\)SetNullFilter}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_matcher_1_1_property_name_matcher}{DeepCopy\(\backslash\)Matcher\(\backslash\)PropertyNameMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$object = MyClass::load(123);}
\DoxyCodeLine{echo \$object-\/>id; \textcolor{comment}{// 123}}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$copier-\/>addFilter(\textcolor{keyword}{new} SetNullFilter(), \textcolor{keyword}{new} PropertyNameMatcher(\textcolor{stringliteral}{'id'}));}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = \$copier-\/>copy(\$object);}
\DoxyCodeLine{}
\DoxyCodeLine{echo \$copy-\/>id; \textcolor{comment}{// null}}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md534}{}\doxysubsubsection{$<$tt$>$\+Keep\+Filter$<$/tt$>$ (filter)}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md534}
If you want a property to remain untouched (for example, an association to an object)\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_filter_1_1_keep_filter}{DeepCopy\(\backslash\)Filter\(\backslash\)KeepFilter}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_matcher_1_1_property_matcher}{DeepCopy\(\backslash\)Matcher\(\backslash\)PropertyMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$copier-\/>addFilter(\textcolor{keyword}{new} KeepFilter(), \textcolor{keyword}{new} PropertyMatcher(\textcolor{stringliteral}{'MyClass'}, \textcolor{stringliteral}{'category'}));}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = \$copier-\/>copy(\$object);}
\DoxyCodeLine{\textcolor{comment}{// \$copy-\/>category has not been touched}}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md535}{}\doxysubsubsection{$<$tt$>$\+Doctrine\+Collection\+Filter$<$/tt$>$ (filter)}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md535}
If you use Doctrine and want to copy an entity, you will need to use the {\ttfamily Doctrine\+Collection\+Filter}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_filter_1_1_doctrine_1_1_doctrine_collection_filter}{DeepCopy\(\backslash\)Filter\(\backslash\)Doctrine\(\backslash\)DoctrineCollectionFilter}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_matcher_1_1_property_type_matcher}{DeepCopy\(\backslash\)Matcher\(\backslash\)PropertyTypeMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$copier-\/>addFilter(\textcolor{keyword}{new} DoctrineCollectionFilter(), \textcolor{keyword}{new} PropertyTypeMatcher(\textcolor{stringliteral}{'Doctrine\(\backslash\)Common\(\backslash\)Collections\(\backslash\)Collection'}));}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = \$copier-\/>copy(\$object);}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md536}{}\doxysubsubsection{$<$tt$>$\+Doctrine\+Empty\+Collection\+Filter$<$/tt$>$ (filter)}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md536}
If you use Doctrine and want to copy an entity who contains a {\ttfamily Collection} that you want to be reset, you can use the {\ttfamily Doctrine\+Empty\+Collection\+Filter}


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_filter_1_1_doctrine_1_1_doctrine_empty_collection_filter}{DeepCopy\(\backslash\)Filter\(\backslash\)Doctrine\(\backslash\)DoctrineEmptyCollectionFilter}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_matcher_1_1_property_matcher}{DeepCopy\(\backslash\)Matcher\(\backslash\)PropertyMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$copier-\/>addFilter(\textcolor{keyword}{new} DoctrineEmptyCollectionFilter(), \textcolor{keyword}{new} PropertyMatcher(\textcolor{stringliteral}{'MyClass'}, \textcolor{stringliteral}{'myProperty'}));}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = \$copier-\/>copy(\$object);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// \$copy-\/>myProperty will return an empty collection}}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md537}{}\doxysubsubsection{$<$tt$>$\+Doctrine\+Proxy\+Filter$<$/tt$>$ (filter)}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md537}
If you use Doctrine and use cloning on lazy loaded entities, you might encounter errors mentioning missing fields on a Doctrine proxy class (...\textbackslash{}\+\_\+\+\_\+\+CG\+\_\+\+\_\+\textbackslash{}\+Proxy). You can use the {\ttfamily Doctrine\+Proxy\+Filter} to load the actual entity behind the Doctrine proxy class. {\bfseries{Make sure, though, to put this as one of your very first filters in the filter chain so that the entity is loaded before other filters are applied!}}


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_filter_1_1_doctrine_1_1_doctrine_proxy_filter}{DeepCopy\(\backslash\)Filter\(\backslash\)Doctrine\(\backslash\)DoctrineProxyFilter}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_matcher_1_1_doctrine_1_1_doctrine_proxy_matcher}{DeepCopy\(\backslash\)Matcher\(\backslash\)Doctrine\(\backslash\)DoctrineProxyMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$copier-\/>addFilter(\textcolor{keyword}{new} DoctrineProxyFilter(), \textcolor{keyword}{new} DoctrineProxyMatcher());}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = \$copier-\/>copy(\$object);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// \$copy should now contain a clone of all entities, including those that were not yet fully loaded.}}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md538}{}\doxysubsubsection{$<$tt$>$\+Replace\+Filter$<$/tt$>$ (type filter)}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md538}

\begin{DoxyEnumerate}
\item If you want to replace the value of a property\+:
\end{DoxyEnumerate}


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_filter_1_1_replace_filter}{DeepCopy\(\backslash\)Filter\(\backslash\)ReplaceFilter}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_matcher_1_1_property_matcher}{DeepCopy\(\backslash\)Matcher\(\backslash\)PropertyMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$callback = \textcolor{keyword}{function} (\$currentValue) \{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} \$currentValue . \textcolor{stringliteral}{' (copy)'}}
\DoxyCodeLine{\};}
\DoxyCodeLine{\$copier-\/>addFilter(\textcolor{keyword}{new} ReplaceFilter(\$callback), \textcolor{keyword}{new} PropertyMatcher(\textcolor{stringliteral}{'MyClass'}, \textcolor{stringliteral}{'title'}));}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = \$copier-\/>copy(\$object);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// \$copy-\/>title will contain the data returned by the callback, e.g. 'The title (copy)'}}

\end{DoxyCode}



\begin{DoxyEnumerate}
\item If you want to replace whole element\+:
\end{DoxyEnumerate}


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_type_filter_1_1_replace_filter}{DeepCopy\(\backslash\)TypeFilter\(\backslash\)ReplaceFilter}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_type_matcher_1_1_type_matcher}{DeepCopy\(\backslash\)TypeMatcher\(\backslash\)TypeMatcher}};}
\DoxyCodeLine{}
\DoxyCodeLine{\$copier = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$callback = \textcolor{keyword}{function} (MyClass \$myClass) \{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} get\_class(\$myClass);}
\DoxyCodeLine{\};}
\DoxyCodeLine{\$copier-\/>addTypeFilter(\textcolor{keyword}{new} ReplaceFilter(\$callback), \textcolor{keyword}{new} TypeMatcher(\textcolor{stringliteral}{'MyClass'}));}
\DoxyCodeLine{}
\DoxyCodeLine{\$copy = \$copier-\/>copy([\textcolor{keyword}{new} MyClass, \textcolor{stringliteral}{'some string'}, \textcolor{keyword}{new} MyClass]);}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{comment}{// \$copy will contain ['MyClass', 'some string', 'MyClass']}}

\end{DoxyCode}


The {\ttfamily \$callback} parameter of the {\ttfamily Replace\+Filter} constructor accepts any PHP callable.\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md539}{}\doxysubsubsection{$<$tt$>$\+Shallow\+Copy\+Filter$<$/tt$>$ (type filter)}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md539}
Stop {\itshape Deep\+Copy} from recursively copying element, using standard {\ttfamily clone} instead\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_deep_copy}{DeepCopy\(\backslash\)DeepCopy}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_type_filter_1_1_shallow_copy_filter}{DeepCopy\(\backslash\)TypeFilter\(\backslash\)ShallowCopyFilter}};}
\DoxyCodeLine{use \mbox{\hyperlink{class_deep_copy_1_1_type_matcher_1_1_type_matcher}{DeepCopy\(\backslash\)TypeMatcher\(\backslash\)TypeMatcher}};}
\DoxyCodeLine{use Mockery as m;}
\DoxyCodeLine{}
\DoxyCodeLine{\$this-\/>deepCopy = \textcolor{keyword}{new} DeepCopy();}
\DoxyCodeLine{\$this-\/>deepCopy-\/>addTypeFilter(}
\DoxyCodeLine{    \textcolor{keyword}{new} ShallowCopyFilter,}
\DoxyCodeLine{    \textcolor{keyword}{new} TypeMatcher(m\(\backslash\)MockInterface::class)}
\DoxyCodeLine{);}
\DoxyCodeLine{}
\DoxyCodeLine{\$myServiceWithMocks = \textcolor{keyword}{new} MyService(m::mock(MyDependency1::class), m::mock(MyDependency2::class));}
\DoxyCodeLine{\textcolor{comment}{// All mocks will be just cloned, not deep copied}}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md540}{}\doxysection{Edge cases}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md540}
The following structures cannot be deep-\/copied with PHP Reflection. As a result they are shallow cloned and filters are not applied. There is two ways for you to handle them\+:


\begin{DoxyItemize}
\item Implement your own {\ttfamily \+\_\+\+\_\+clone()} method
\item Use a filter with a type matcher
\end{DoxyItemize}\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md541}{}\doxysection{Contributing}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md541}
Deep\+Copy is distributed under the MIT license.\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md542}{}\doxysubsection{Tests}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md542}
Running the tests is simple\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{vendor/bin/phpunit}

\end{DoxyCode}
\hypertarget{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md543}{}\doxysubsection{Support}\label{md_vendor_myclabs_deep_copy__r_e_a_d_m_e_autotoc_md543}
Get professional support via \href{https://tidelift.com/subscription/pkg/packagist-myclabs-deep-copy?utm_source=packagist-myclabs-deep-copy&utm_medium=referral&utm_campaign=readme}{\texttt{ the Tidelift Subscription}}. 