<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>village green: TableGenerator Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">village green
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>Doctrine</b></li><li class="navelem"><b>DBAL</b></li><li class="navelem"><b>Id</b></li><li class="navelem"><a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_id_1_1_table_generator.html">TableGenerator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle"><div class="title">TableGenerator Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aecef3b12dc82b16c33d5767d26054c03"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_id_1_1_table_generator.html#aecef3b12dc82b16c33d5767d26054c03">__construct</a> (<a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_connection.html">Connection</a> $conn, $generatorTableName='sequences')</td></tr>
<tr class="separator:aecef3b12dc82b16c33d5767d26054c03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab446ffc52d78e30899b1466ae254cc45"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_id_1_1_table_generator.html#ab446ffc52d78e30899b1466ae254cc45">nextValue</a> ($sequence)</td></tr>
<tr class="separator:ab446ffc52d78e30899b1466ae254cc45"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Table ID Generator for those poor languages that are missing sequences.</p>
<p >WARNING: The Table Id Generator clones a second independent database connection to work correctly. This means using the generator requests that generate IDs will have two open database connections. This is necessary to be safe from transaction failures in the main connection. Make sure to only ever use one <a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_id_1_1_table_generator.html">TableGenerator</a> otherwise you end up with many connections.</p>
<p >TableID Generator does not work with SQLite.</p>
<p >The <a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_id_1_1_table_generator.html">TableGenerator</a> does not take care of creating the SQL Table itself. You should look at the <code><a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_id_1_1_table_generator_schema_visitor.html">TableGeneratorSchemaVisitor</a></code> to do this for you. Otherwise the schema for a table looks like:</p>
<p >CREATE sequences ( sequence_name VARCHAR(255) NOT NULL, sequence_value INT NOT NULL DEFAULT 1, sequence_increment_by INT NOT NULL DEFAULT 1, PRIMARY KEY (sequence_name) );</p>
<p >Technically this generator works as follows:</p>
<ol type="1">
<li>Use a robust transaction serialization level.</li>
<li>Open transaction</li>
<li>Acquire a read lock on the table row (SELECT .. FOR UPDATE)</li>
<li>Increment current value by one and write back to database</li>
<li>Commit transaction</li>
</ol>
<p >If you are using a sequence_increment_by value that is larger than one the ID Generator will keep incrementing values until it hits the incrementation gap before issuing another query.</p>
<p >If no row is present for a given sequence a new one will be created with the default values 'value' = 1 and 'increment_by' = 1</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000059">Deprecated:</a></b></dt><dd></dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aecef3b12dc82b16c33d5767d26054c03" name="aecef3b12dc82b16c33d5767d26054c03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecef3b12dc82b16c33d5767d26054c03">&#9670;&nbsp;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">__construct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_connection.html">Connection</a>&#160;</td>
          <td class="paramname"><em>$conn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$generatorTableName</em> = <code>'sequences'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$generatorTableName</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_exception.html">Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab446ffc52d78e30899b1466ae254cc45" name="ab446ffc52d78e30899b1466ae254cc45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab446ffc52d78e30899b1466ae254cc45">&#9670;&nbsp;</a></span>nextValue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nextValue </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sequence</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Generates the next unused value for the given sequence name.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$sequence</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="class_doctrine_1_1_d_b_a_l_1_1_exception.html">Exception</a></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>vendor/doctrine/dbal/src/Id/TableGenerator.php</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
